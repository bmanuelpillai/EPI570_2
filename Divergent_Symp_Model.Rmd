---
title: "epi570-model-testing"
output: pdf_document
date: "`r Sys.Date()`"
---
setting up / loading packages
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

pacman::p_load(pacman, EpiModel, ggplot2, tidyverse, reshape2)
```

**PENDING THOUGHTS**
Can't get the combined vaccine scenario to work. Thinking about scraping that, also in the interest of time.

build model foundation:
    - conceptualized as relatively low baseline vaccination rate with 9vHPV vaccine
    - vaccine assumed to have immunogenecity (~97% produce sufficient response)
    - vaccinated people assumed to become infected through vaccine leak (~90% efficacy)
    - vaccine assumed to act through prevention of infection in vaccinated people (lower FOI) 
```{r Vaccination Model}
Vaccination <- function(t, t0, parms) {
  with(as.list(c(t0, parms)), {
    
#1. Track Population Sizes ###############################################################
    # total male population size
    m.num = uv.m.ue.num + uv.m.e.num + uv.m.i.a.num + uv.m.i.s.num + 
            v.m.ue.num  + v.m.e.num  + v.m.i.a.num  + v.m.i.s.num

    # total female population size
    f.num = uv.f.ue.num + uv.f.e.num + uv.f.i.a.num + uv.f.i.s.num + 
            v.f.ue.num  + v.f.e.num  + v.f.i.a.num  + v.f.i.s.num

    # total population
    num = f.num + m.num

    # infected numbers for contact proportions
    i.m.num = uv.m.i.a.num + uv.m.i.s.num + v.m.i.a.num  + v.m.i.s.num   # males
    i.f.num = uv.f.i.a.num + uv.f.i.s.num + v.f.i.a.num  + v.f.i.s.num   # females
  
    
#2. Define Contact Rate ##################################################################
    # contact rate for females dependent on contact rate for males
    # forcing dissortative heterosexual contact only
    ce.f <- (ce.m * m.num) / f.num


#3. Define Lambda ########################################################################
    # conceptualizing 9vHPV Gardasil vaccine as reducing likelihood of becoming infected 
    # with HPV due to high efficacy (psi). thus, dynamics of HPV itself are same between
    # susceptible & vaccinated, but the vaccinated FOI is reduced by the complement of vaccine
    # efficacy (1-psi)
    
    ### EXTERNAL FOI ADD?
    
  # susceptibles
    # males
    #lambda.m.s.ex <- (tau) * (ce.m) * (i.f.prev) 
    lambda.m.s <- (tau) * (ce.m) * (i.f.num / f.num)
    #lambda.m.s <- lambda.m.s.ex + lambda.m.s.in
    # females
    #lambda.f.s.ex <-  (tau) * (ce.f) * (i.m.prev)
    lambda.f.s <-  (tau) * (ce.f) * (i.m.num / m.num)
    #lambda.f.s <- lambda.f.s.ex + lambda.f.s.in
    # This is a constant while the force of infection wont change based on the changing prevalence in males. How can we include the population prevalence and population specific prevalence
  
  # vaccinated
    # males
    lambda.m.v <- (tau)*(1-psi) * (ce.m)*(i.f.num / f.num)
    #lambda.m.v <- (tau)*(1-psi) * (ce.m)*(i.f.prev) 
    # females
    lambda.f.v <-  (tau)*(1-psi) * (ce.f)*(i.m.num / m.num)
    #lambda.f.v <-  (tau)*(1-psi) * (ce.f)*(i.m.prev)


#4. Define Additional parameters #########################################################
  # recovery rate: 1/duration of infection, allowing for differential clearing rate by vax status & symptomatic status 
    # susceptible recovery rate
      delta.s.a <- 1/dur.inf.s.a
      delta.s.s <- 1/dur.inf.s.s
    # vaccinated recovery rate
      delta.v.a <- 1/dur.inf.v.a
      delta.v.s <- 1/dur.inf.v.s
    
    # zeta is the proportion of susceptibles that become symptomatic 
    # kappa is the proportion of susceptible exposed that become vaccinated exposed at each timestep
    # nu is birthrate

#5. Define Differential Equations ########################################################
  
# MALES : SUSCEPTIBLE
  # susceptible unexposed (11-18 yrs old) [uv.m.ue.num]
  dS.m.ue <- ((0.5 * (1-omega.m*chi) * nu*num)) +            # births
             (-age.in * uv.m.ue.num) + (-mu.ue * uv.m.ue.num)  # gen pop
      # entry multiplied by half to account for M/F strata
      # S populated by complement of proportion vaccinated*proportion immunologic

  # susceptible exposed (18+, proxy for sexually active) [uv.m.e.num]
  dS.m.e <- (age.in * uv.m.ue.num) + (-mu * uv.m.e.num) + (-age.out * uv.m.e.num) +         # general pop
            (-lambda.m.s * zeta.s * uv.m.e.num) + (-lambda.m.s * (1-zeta.s) * uv.m.e.num) + # exposure
            (delta.s.a * uv.m.i.a.num) + (delta.s.s * uv.m.i.s.num) +                       # recovery
            (-kappa * uv.m.e.num)                                                         # catch-up vax
  
 # infected asymptomatic [uv.m.i.a.num]
  dI.m.s.a <- (-age.out * uv.m.i.a.num) + (-mu * uv.m.i.a.num) +  # general pop
              (lambda.m.s * (1-zeta.s) * uv.m.e.num) +           # asymptomatic infection
              (-delta.s.a * uv.m.i.a.num)                         # recovery
    
  # infected symptomatic [uv.m.i.s.num]
  dI.m.s.s <- (lambda.m.s * zeta.s * uv.m.e.num) +               # symptomatic infection
              (-delta.s.s * uv.m.i.s.num) +                        # recovery
              (-age.out * uv.m.i.s.num) + (-mu * uv.m.i.s.num)       # general pop


# MALES : VACCINATED
  # vaccinated unexposed [v.m.ue.num]
  dV.m.ue <- (0.5 * omega.m * chi * nu * num) +              # births
             (-age.in * v.m.ue.num) + (-mu.ue * v.m.ue.num)  # general pop

  # vaccinated exposed/sexually active [v.m.e.num]
  dV.m.e <- (age.in * v.m.ue.num) + (-age.out * v.m.e.num) + (-mu * v.m.e.num) +         # general pop
            (-lambda.m.v * (zeta.v) * v.m.e.num) + (-lambda.m.v * (1- zeta.v) * v.m.e.num) + # exposure
            (delta.v.a * v.m.i.a.num) + (delta.v.s * v.m.i.s.num) +                      # recovery
            (kappa * uv.m.e.num)                                                       # catch-up vax

  # infected asymptomatic [v.m.i.a.num]
  dI.m.v.a <- (-age.out * v.m.i.a.num) + (-mu * v.m.i.a.num) +        # gen pop
              (lambda.m.v * (1- zeta.v) * v.m.e.num) +                 # asymptomatic infection
              (-delta.v.a * v.m.i.a.num)                              # recovery
  # infected symptomatic [v.m.i.s.num]
  dI.m.v.s <- (-age.out * v.m.i.s.num) + (-mu * v.m.i.s.num) +        # gen pop
              (lambda.m.v * (zeta.v) * v.m.e.num) +                    # symptomatic infection
              (-delta.v.s * v.m.i.s.num)                              # recovery  

  
# FEMALES : SUSCEPTIBLE
  # unexposed [uv.f.ue.num]
  dS.f.ue <- ((0.5 * (1-omega.f*chi) * nu * num)) - (age.in * uv.f.ue.num) - (mu.ue * uv.f.ue.num)
  
  # exposed/sexually active [uv.f.e.num]
  dS.f.e <- (age.in * uv.f.ue.num) + (-mu * uv.f.e.num) + (-age.out * uv.f.e.num) +       # general pop
            (-lambda.f.s * zeta.s * uv.f.e.num) + (-lambda.f.s * (1-zeta.s) * uv.f.e.num) +   # exposure
            (delta.s.a * uv.f.i.a.num) + (delta.s.s * uv.f.i.s.num) +                     # recovery
            (-kappa * uv.f.e.num)                                                       # catch-up vax
  
  # infected, asymptomatic [uv.f.i.a.num]
  dI.f.s.a <- (-age.out * uv.f.i.a.num) + (-mu * uv.f.i.a.num) +  # general pop
              (lambda.f.s * (1-zeta.s) * uv.f.e.num) +              # asymptomatic infection
              (-delta.s.a * uv.f.i.a.num)                         # recovery
    
  # infected, symptomatic [uv.f.i.s.num]
  dI.f.s.s <- (lambda.f.s * zeta.s * uv.f.e.num) +                     # symptomatic infection
              (-delta.s.s * uv.f.i.s.num) +                          # recovery
              (-age.out * uv.f.i.s.num) + (-mu * uv.f.i.s.num)       # general pop

  
# FEMALES : VACCINATED
  # unexposed [v.f.ue.num]
  dV.f.ue <- (0.5 * omega.f * chi * nu * num) +              # births
             (-age.in * v.f.ue.num) + (-mu.ue * v.f.ue.num)  # general pop
  # exposed [v.f.e.num]
  dV.f.e <- (age.in * v.f.ue.num) + (-age.out * v.f.e.num) + (-mu * v.f.e.num) +       # gen pop
            (-lambda.f.v * zeta.v * v.f.e.num) + (-lambda.f.v * (1-zeta.v) * v.f.e.num) +  # infection
            (delta.v.a * v.f.i.a.num) + (delta.v.s * v.f.i.s.num) +                    # recovery
            (kappa * uv.f.e.num)                                                       # catch-up vax

  # infected, asymptomatic [v.f.i.a.num]
  dI.f.v.a <- (-age.out * v.f.i.a.num) + (-mu * v.f.i.a.num) +        # gen pop
              (lambda.f.v * (1-zeta.v) * v.f.e.num) +                   # asymptomatic infection
              (-delta.v.a * v.f.i.a.num)                              # recovery
  # infected, symptomatic [v.f.i.s.num]
  dI.f.v.s <- (-age.out * v.f.i.s.num) + (-mu * v.f.i.s.num) +        # gen pop
              (lambda.f.v * zeta.v * v.f.e.num) +                       # symptomatic infection
              (-delta.v.s * v.f.i.s.num)                              # recovery  

  
  
# 6.Outputs ##############################################################################
list(c(dS.m.ue, dS.m.e, dI.m.s.a, dI.m.s.s, 
       dV.m.ue, dV.m.e, dI.m.v.a, dI.m.v.s,
       dS.f.ue, dS.f.e, dI.f.s.a, dI.f.s.s, 
       dV.f.ue, dV.f.e, dI.f.v.a, dI.f.v.s,
       si.m.flow = (lambda.m.s * uv.m.e.num),
       vi.m.flow = (lambda.m.v * v.m.e.num),
       sv.m.flow = (kappa * uv.m.e.num),
       si.f.flow = (lambda.f.s * uv.f.e.num),
       vi.f.flow = (lambda.f.v * v.f.e.num),
       sv.f.flow = (kappa * uv.f.e.num))
       )
  })
}

```

## BASELINE PARAMETERS / INTIIALS
```{r}
# Vaccination Scenario 1.) Male vaccination at birth increased from 0.1 to 0.8 by 0.2       
param1 <- param.dcm( # FOI PARAMETERS
                    tau = 0.40, # median per-act transmission prob (Burchell, et al. 2006)
                    psi = 0.90, # Gardasil Merck vaccine efficacy
                    ce.m = (30/365), # contact parameter assumed based on sexual activity data
                    
                    # GENERAL POP PARAMETERS
                    # infection prevalence for whole pop assumed from mid-2010s prevalence in mid 40-50%
                    i.f.prev = 0.4, # US population prevalence of HPV amoung women
                    i.m.prev = 0.4, # US population prevalence of HPV amoung men
                    nu = (((20)/1000)/365), # sensitivity parameter to ensure stable population
                    mu.ue = (60/1e5)/365, # estimated all-cause mortality 2019 0-14 for study region
                    mu = (400/1e5)/365, # estimated all-cause mortality 2019 15-65 for study region
                    age.in = (1/(7*365)), age.out = (1/(47*365)),
                    
                    # RECOVERY PARAMETERS
                        # assumed median duration w/o variation by symptoms
                        dur.inf.s.a = (1.5*365), dur.inf.s.s= (1.5*365), 
                        # assumed reduction in duration due to vaccination
                        dur.inf.v.a = (1.25*365), dur.inf.v.s = (1.25*365),
                    
                    # VACCINE PARAMETERS
                    # omegas assumed from national average UTD; southeastern disparity; sex-specific disparity
                    omega.m = 0.4, omega.f = 0.6, 
                    chi = 0.92, # estimates for 9vHPV >90% through 90mo; weighted down for incr age band (Olsson, et al. 2020)
                    kappa = ((0.02)/365), # catch-up vax rates assumed 1% in adults from 2011-2016
                    # symptomatic parameters
                    # zeta is the proportion of susceptible that become symptomatic
                    zeta.v = (0.2) , zeta.s = (0.2))


init <- init.dcm( # males
                 uv.m.ue.num = 1.6e6, uv.m.e.num = 8.2e6,
                 uv.m.i.a.num = 2.8e5, uv.m.i.s.num= 2.5e6,
                 v.m.ue.num = 3.04e5, v.m.e.num = 1e7, 
                 v.m.i.a.num = 3.2e6, v.m.i.s.num = 3.6e5,
                 # females
                 uv.f.ue.num = 1.7e6, uv.f.e.num = 5.8e6, 
                 uv.f.i.a.num = 3.5e6, uv.f.i.s.num = 3.7e5,
                 v.f.ue.num = 2.4e5, v.f.e.num = 3.2e6, 
                 v.f.i.a.num = 9e6, v.f.i.s.num = 1e6,
                 # flows
                 si.m.flow = 0, vi.m.flow = 0, sv.m.flow = 0,
                 si.f.flow = 0, vi.f.flow = 0, sv.f.flow = 0)



control <- control.dcm(nsteps = (50*365), new.mod = Vaccination)

mod1 <- dcm(param1, init, control)
mod1
```



## INTERVENTION SCENARIO #1: MALE VACCINATION INCREASED
```{r Omega.f Vaccination}
# Vaccination Scenario 1.) Male vaccination at birth increased from 0.1 to 0.8 by 0.2       
param2 <- param.dcm( # FOI PARAMETERS
                    tau = 0.40, # median per-act transmission prob (Burchell, et al. 2006)
                    psi = 0.90, # Gardasil Merck vaccine efficacy
                    ce.m = (30/365), # contact parameter assumed based on sexual activity data
                    
                    # GENERAL POP PARAMETERS
                    # infection prevalence for whole pop assumed from mid-2010s prevalence in mid 40-50%
                    i.f.prev = 0.4, # US population prevalence of HPV amoung women
                    i.m.prev = 0.4, # US population prevalence of HPV amoung men
                    nu = (((20)/1000)/365), # sensitivity parameter to ensure stable population
                    mu.ue = (60/1e5)/365, # estimated all-cause mortality 2019 0-14 for study region
                    mu = (400/1e5)/365, # estimated all-cause mortality 2019 15-65 for study region
                    age.in = (1/(7*365)), age.out = (1/(47*365)),
                    
                    # RECOVERY PARAMETERS
                        # assumed median duration w/o variation by symptoms
                        dur.inf.s.a = (1.5*365), dur.inf.s.s= (1.5*365), 
                        # assumed reduction in duration due to vaccination
                        dur.inf.v.a = (1.25*365), dur.inf.v.s = (1.25*365),
                    
                    # VACCINE PARAMETERS
                    omega.m = c(0.1,0.2,0.3,0.4), omega.f = 0.40, 
                    chi = 0.97, kappa = (0.0025/365),
                    # symptomatic parameters
                    # zeta is the proportion of susceptible that become symptomatic
                    zeta.v = (0.2) , zeta.s = (0.2))


mod2 <- dcm(param2, init, control)
mod2
```

## INTERVENTION SCENARIO #2: CATCH-UP VACCINATION INCREASED
```{r Kappa Vaccination}
# Vaccination Scenario 2.) Catch-up Vaccination increased from 0.01 to 0.04
param3 <- param.dcm( # FOI PARAMETERS
                    tau = 0.40, # median per-act transmission prob (Burchell, et al. 2006)
                    psi = 0.90, # Gardasil Merck vaccine efficacy
                    ce.m = (30/365), # contact parameter assumed based on sexual activity data
                    
                    # GENERAL POP PARAMETERS
                    # infection prevalence for whole pop assumed from mid-2010s prevalence in mid 40-50%
                    i.f.prev = 0.4, # US population prevalence of HPV amoung women
                    i.m.prev = 0.4, # US population prevalence of HPV amoung men
                    nu = (((20)/1000)/365), # sensitivity parameter to ensure stable population
                    mu.ue = (60/1e5)/365, # estimated all-cause mortality 2019 0-14 for study region
                    mu = (400/1e5)/365, # estimated all-cause mortality 2019 15-65 for study region
                    age.in = (1/(7*365)), age.out = (1/(47*365)),
                    
                    # RECOVERY PARAMETERS
                        # assumed median duration w/o variation by symptoms
                        dur.inf.s.a = (1.5*365), dur.inf.s.s= (1.5*365), 
                        # assumed reduction in duration due to vaccination
                        dur.inf.v.a = (1.25*365), dur.inf.v.s = (1.25*365),
                    
                    # VACCINE PARAMETERS
                    omega.m = 0.10, omega.f = 0.40, 
                    chi = 0.97, kappa = c((0.01/365), (0.02/365), (0.03/365), (0.04/365)),
                    # symptomatic parameters
                    # zeta is the proportion of susceptible that become symptomatic
                    zeta.v = (0.2) , zeta.s = (0.2))


mod3 <- dcm(param3, init, control)
mod3
```

## INTERVENTION SCENARIO #3: COMBINED VACCINATION STRATEGY
```{r Combined Vaccination}
# Vaccination Scenario 3.) Combine previous scenarios
param4 <- param.dcm( # FOI PARAMETERS
                    tau = 0.40, # median per-act transmission prob (Burchell, et al. 2006)
                    psi = 0.90, # Gardasil Merck vaccine efficacy
                    ce.m = (30/365), # contact parameter assumed based on sexual activity data
                    
                    # GENERAL POP PARAMETERS
                    # infection prevalence for whole pop assumed from mid-2010s prevalence in mid 40-50%
                    i.f.prev = 0.4, # US population prevalence of HPV amoung women
                    i.m.prev = 0.4, # US population prevalence of HPV amoung men
                    nu = (((20)/1000)/365), # sensitivity parameter to ensure stable population
                    mu.ue = (60/1e5)/365, # estimated all-cause mortality 2019 0-14 for study region
                    mu = (400/1e5)/365, # estimated all-cause mortality 2019 15-65 for study region
                    age.in = (1/(7*365)), age.out = (1/(47*365)),
                    
                    # RECOVERY PARAMETERS
                        # assumed median duration w/o variation by symptoms
                        dur.inf.s.a = (1.5*365), dur.inf.s.s= (1.5*365), 
                        # assumed reduction in duration due to vaccination
                        dur.inf.v.a = (1.25*365), dur.inf.v.s = (1.25*365),
                    
                    
                    # VACCINE PARAMETERS
                    omega.m = seq(0.1, 0.4, by = 0.1), omega.f = 0.30, 
                    chi = 0.97, kappa = c((0.01/365), (0.02/365), (0.03/365), (0.04/354)),
                    # symptomatic parameters
                    # zeta is the proportion of susceptible that become symptomatic
                    zeta.v = (0.2) , zeta.s = (0.2))



mod4 <- dcm(param4, init, control)
mod4
```


Plotting Omega Vaccine Scenario
```{r Vaccination Scenario 1}
mod1 <- mutate_epi(mod1, m.num = uv.m.ue.num + uv.m.e.num + uv.m.i.a.num + uv.m.i.s.num + 
                               v.m.ue.num  + v.m.e.num  + v.m.i.a.num  + v.m.i.s.num)

mod1 <- mutate_epi(mod1, f.num = uv.f.ue.num + uv.f.e.num + uv.f.i.a.num + uv.f.i.s.num + 
                               v.f.ue.num  + v.f.e.num  + v.f.i.a.num  + v.f.i.s.num)

mod1 <- mutate_epi(mod1, i.m.num = uv.m.i.a.num + uv.m.i.s.num + v.m.i.a.num  + v.m.i.s.num)
mod1 <- mutate_epi(mod1, i.f.num = uv.f.i.a.num + uv.f.i.s.num + v.f.i.a.num  + v.f.i.s.num)

mod1 <- mutate_epi(mod1, m.prev = i.m.num / m.num)
mod1 <- mutate_epi(mod1, f.prev = i.f.num / f.num)

model1 <- as.data.frame(mod1)


mod2 <- mutate_epi(mod2, m.num = uv.m.ue.num + uv.m.e.num + uv.m.i.a.num + uv.m.i.s.num + 
                               v.m.ue.num  + v.m.e.num  + v.m.i.a.num  + v.m.i.s.num)

mod2 <- mutate_epi(mod2, f.num = uv.f.ue.num + uv.f.e.num + uv.f.i.a.num + uv.f.i.s.num + 
                               v.f.ue.num  + v.f.e.num  + v.f.i.a.num  + v.f.i.s.num)

mod2 <- mutate_epi(mod2, i.m.num = uv.m.i.a.num + uv.m.i.s.num + v.m.i.a.num  + v.m.i.s.num)
mod2 <- mutate_epi(mod2, i.f.num = uv.f.i.a.num + uv.f.i.s.num + v.f.i.a.num  + v.f.i.s.num)

mod2 <- mutate_epi(mod2, m.prev = i.m.num / m.num)
mod2 <- mutate_epi(mod2, f.prev = i.f.num / f.num)

model2 <- as.data.frame(mod2)


mod3 <- mutate_epi(mod3, m.num = uv.m.ue.num + uv.m.e.num + uv.m.i.a.num + uv.m.i.s.num + 
                               v.m.ue.num  + v.m.e.num  + v.m.i.a.num  + v.m.i.s.num)

mod3 <- mutate_epi(mod3, f.num = uv.f.ue.num + uv.f.e.num + uv.f.i.a.num + uv.f.i.s.num + 
                               v.f.ue.num  + v.f.e.num  + v.f.i.a.num  + v.f.i.s.num)

mod3 <- mutate_epi(mod3, i.m.num = uv.m.i.a.num + uv.m.i.s.num + v.m.i.a.num  + v.m.i.s.num)
mod3 <- mutate_epi(mod3, i.f.num = uv.f.i.a.num + uv.f.i.s.num + v.f.i.a.num  + v.f.i.s.num)

mod3 <- mutate_epi(mod3, m.prev = i.m.num / m.num)
mod3 <- mutate_epi(mod3, f.prev = i.f.num / f.num)

model3 <- as.data.frame(mod3)


mod4 <- mutate_epi(mod4, m.num = uv.m.ue.num + uv.m.e.num + uv.m.i.a.num + uv.m.i.s.num + 
                               v.m.ue.num  + v.m.e.num  + v.m.i.a.num  + v.m.i.s.num)

mod4 <- mutate_epi(mod4, f.num = uv.f.ue.num + uv.f.e.num + uv.f.i.a.num + uv.f.i.s.num + 
                               v.f.ue.num  + v.f.e.num  + v.f.i.a.num  + v.f.i.s.num)

mod4 <- mutate_epi(mod4, i.m.num = uv.m.i.a.num + uv.m.i.s.num + v.m.i.a.num  + v.m.i.s.num)
mod4 <- mutate_epi(mod4, i.f.num = uv.f.i.a.num + uv.f.i.s.num + v.f.i.a.num  + v.f.i.s.num)

mod4 <- mutate_epi(mod4, m.prev = i.m.num / m.num)
mod4 <- mutate_epi(mod4, f.prev = i.f.num / f.num)

model4 <- as.data.frame(mod4)
```

```{r Unvaccinated Asymptomatic Graphs}
par(mfrow = c(2,3))

plot(mod2, y = c('uv.m.i.a.num'),
          main = "Unvaccinated Asymptomatic\nMales\n(Male Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.m.i.a.num'),
          main = "Unvaccinated Asymptomatic\nMales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.m.i.a.num'),
          main = "Unvaccinated Asymptomatic\nMales\n(Combination Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
############# Females
plot(mod2, y = c('uv.f.i.a.num'),
          main = "Unvaccinated Asymptomatic\nFemales\n(Male Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.f.i.a.num'),
          main = "Unvaccinated Asymptomatic\nFemales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.f.i.a.num'),
          main = "Unvaccinated Asymptomatic\nFemales\n(Combination Vaccination)",
          xlim = c(750, 15000), ylim = c(6000000, 10000000))
     legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

```
```{r Unvaccinated Symptomatic Graphs}
par(mfrow = c(2,3))
plot(mod2, y = c('uv.m.i.s.num'),
          main = "Unvaccinated Symptomatic\nMales\n(Male Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.m.i.s.num'),
          main = "Unvaccinated Symptomatic\nMales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.m.i.s.num'),
          main = "Unvaccinated Symptomatic\nMales\n(Combination Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
############# Females
plot(mod2, y = c('uv.f.i.s.num'),
          main = "Unvaccinated Symptomatic\nFemales\n(Male Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.f.i.s.num'),
          main = "Unvaccinated Symptomatic\nFemales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.f.i.s.num'),
          main = "Unvaccinated Symptomatic\nFemales\n(Combination Vaccination)",
          xlim = c(750, 15000))
     legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
```

```{r Susceptible Graphs}
par(mfrow = c(2,3))
plot(mod2, y = c('uv.m.e.num'),
          main = "Unexposed\nMales\n(Male Vaccination)",
          xlim = c(750, 15000), ylim = c(500000,1200000))
     legend("bottomright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.m.e.num'),
          main = "Unexposed\nMales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000), ylim = c(500000,1200000))
     legend("bottomright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.m.e.num'),
          main = "Unexposed\nMales\n(Combination Vaccination)",
          xlim = c(750, 15000), ylim = c(500000,1200000))
     legend("bottomright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
############# Females
plot(mod2, y = c('uv.f.e.num'),
          main = "Unexposed\nFemales\n(Male Vaccination)",
          xlim = c(750, 15000), ylim = c(500000, 1200000))
     legend("bottomright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod3, y = c('uv.f.e.num'),
          main = "Unexposed\nFemales\n(Catch-Up Vaccination)",
          xlim = c(750, 15000), ylim = c(500000,1200000))
     legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
     
plot(mod4, y = c('uv.f.e.num'),
          main = "Unexposed\nFemales\n(Combination Vaccination)",
          xlim = c(750, 15000), ylim = c(500000,1200000))
     legend("bottomright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
```

```{r Prevalence Graphed for Vaccination Scenarios}
########################Omega.m Vaccination
par(mfrow = c(1,2))
plot(mod2, y = "m.prev", 
     main = "Increase Childhood Male Vaccination\nProportional Prevalence\nMales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod2, y = "f.prev", 
     main = "Increase Childhood Male Vaccination\nProportional Prevalence\nFemales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

########################Kappa Vaccination
par(mfrow = c(1,2))
plot(mod3, y = "m.prev", 
     main = "Increase Adult Catch-Up Vaccination\nProportional Prevalence\nMales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod3, y = "f.prev", 
     main = "Increase Adult Catch-Up Vaccination\nProportional Prevalence\nFemales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

######################## Omega.f Vaccination
par(mfrow = c(1,2))
plot(mod4, y = "m.prev", 
     main = "Combined Vaccine Scenario\nProportional Prevalence\nMales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod4, y = "f.prev", 
     main = "Combined Vaccine Scenario\nProportional Prevalence\nFemales",
     xlim = c(750, 15000),
     ylim = c(0.6,0.8))
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
```
```{r Flows Graphed for Vaccination Scenarios}
########################Omega.m Vaccination
par(mfrow = c(1,2))
plot(mod2, y = "si.m.flow", 
     main = "Increase Childhood Male Vaccination\nSusceptible Incidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod2, y = "si.f.flow", 
     main = "Increase Childhood Male Vaccination\nSusceptible Incidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

########################Kappa Vaccination
par(mfrow = c(1,2))
plot(mod3, y = "si.m.flow", 
     main = "Increase Adult Catch-Up Vaccination\nSusceptible Incidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod3, y = "si.f.flow", 
     main = "Increase Adult Catch-Up Vaccination\nSusceptible Incidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

######################## Omega.f Vaccination
par(mfrow = c(1,2))
plot(mod4, y = "si.m.flow", 
     main = "Combined Vaccine Scenario\nSusceptible Incidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod4, y = "si.f.flow", 
     main = "Combined Vaccine Scenario\nSusceptibleIncidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
```


```{r Flows Graphed for Vaccination Scenarios}
########################Omega.m Vaccination
par(mfrow = c(1,2))
plot(mod2, y = "vi.m.flow", 
     main = "Increase Childhood Male Vaccination\nIncidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod2, y = "vi.f.flow", 
     main = "Increase Childhood Male Vaccination\nIncidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1", "omega.m = 0.2","omega.m = 0.3", "omega.m = 0.4"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

########################Kappa Vaccination
par(mfrow = c(1,2))
plot(mod3, y = "vi.m.flow", 
     main = "Increase Adult Catch-Up Vaccination\nIncidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod3, y = "vi.f.flow", 
     main = "Increase Adult Catch-Up Vaccination\nIncidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("1% per Year", "2% per Year", "3% per Year", "4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

######################## Omega.f Vaccination
par(mfrow = c(1,2))
plot(mod4, y = "vi.m.flow", 
     main = "Combined Vaccine Scenario\nIncidence\nMales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)

plot(mod4, y = "vi.f.flow", 
     main = "Combined Vaccine Scenario\nIncidence\nFemales",
     xlim = c(750, 15000),
     ylim = c())
legend("topright", legend = c("omega.m = 0.1 + 1% per Year", "omega.m = 0.2 + 2% per Year","omega.m = 0.3 + 3% per Year", "omega.m = 0.4 + 4% per Year"), col = c("red", "blue", "green", "purple"), pch = 19, cex = 0.6)
```







```{r Omega.m Vaccination}
# Isolate Runs
df1<-as.data.frame(mod2, run = 1)
df2<-as.data.frame(mod2, run = 2)
df3<-as.data.frame(mod2, run = 3)
df4<-as.data.frame(mod2, run = 4)

# Vaccination Measures for Females
NIAF2 <- sum(df1$si.f.flow) - sum(df2$si.f.flow)
NIAF3 <- sum(df1$si.f.flow) - sum(df3$si.f.flow)
NIAF4 <- sum(df1$si.f.flow) - sum(df4$si.f.flow)

Percent_Averted_Females <- c(NIAF2*100 / sum(df1$si.f.flow),
                             NIAF3*100 / sum(df1$si.f.flow),
                             NIAF4*100 / sum(df1$si.f.flow))

NNT_Females <- c(sum(df2$v.m.ue.num) / NIAF2,
                 sum(df3$v.m.ue.num) / NIAF3,
                 sum(df4$v.m.ue.num) / NIAF4)

# Vaccination Measures for Females
NIAM2 <- sum(df1$si.m.flow) - sum(df2$si.m.flow)
NIAM3 <- sum(df1$si.m.flow) - sum(df3$si.m.flow)
NIAM4 <- sum(df1$si.m.flow) - sum(df4$si.m.flow)

Percent_Averted_Males <- c(NIAM2*100 / sum(df1$si.m.flow),
                           NIAM3*100 / sum(df1$si.m.flow),
                           NIAM4*100 / sum(df1$si.m.flow))

NNT_Males <- c(sum(df2$v.m.ue.num) / NIAM2,
               sum(df3$v.m.ue.num) / NIAM3,
               sum(df4$v.m.ue.num) / NIAM4)

# Combine Results
male_vaccination <- data.frame(
  Scenario = c("omega.m = 0.2", "omega.m = 0.3", "omega.m = 0.4"),
  NIA_Female = c(NIAF2, NIAF3, NIAF4),
  Percent_Averted_Female = Percent_Averted_Females,
  NNT_Female = NNT_Females,
  NIA_Male = c(NIAM2, NIAM3, NIAM4),
  Percent_Averted_Male = Percent_Averted_Males,
  NNT_Male = NNT_Males
)


View(male_vaccination)
```


```{r}
ggplot(male_vaccination, aes(x = Scenario)) +
  geom_bar(aes(y = NNT_Female, fill = "Female"), stat = "identity", position = position_dodge(width = 0.9)) +
  geom_bar(aes(y = NNT_Male, fill = "Male"), stat = "identity", position = position_dodge(width = 0.9)) +
  labs(title = "NNT for Females vs Males",
       x = "Scenario",
       y = "NNT",
       fill = "Gender") +
  scale_fill_manual(values = c("blue", "red"), labels = c("Female", "Male")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```




```{r Kappa Vaccination}
# Isolate Runs
df1<-as.data.frame(mod3, run = 1)
df2<-as.data.frame(mod3, run = 2)
df3<-as.data.frame(mod3, run = 3)
df4<-as.data.frame(mod3, run = 4)

# Vaccination Measures for Females
NIAF2 <- sum(df1$si.f.flow) - sum(df2$si.f.flow)
NIAF3 <- sum(df1$si.f.flow) - sum(df3$si.f.flow)
NIAF4 <- sum(df1$si.f.flow) - sum(df4$si.f.flow)

Percent_Averted_Females <- c(NIAF2*100 / sum(df1$si.f.flow),
                             NIAF3*100 / sum(df1$si.f.flow),
                             NIAF4*100 / sum(df1$si.f.flow))

NNT_Females <- c(sum(df2$v.m.ue.num) / NIAF2,
                 sum(df3$v.m.ue.num) / NIAF3,
                 sum(df4$v.m.ue.num) / NIAF4)

# Vaccination Measures for Females
NIAM2 <- sum(df1$si.m.flow) - sum(df2$si.m.flow)
NIAM3 <- sum(df1$si.m.flow) - sum(df3$si.m.flow)
NIAM4 <- sum(df1$si.m.flow) - sum(df4$si.m.flow)

Percent_Averted_Males <- c(NIAM2*100 / sum(df1$si.m.flow),
                           NIAM3*100 / sum(df1$si.m.flow),
                           NIAM4*100 / sum(df1$si.m.flow))

NNT_Males <- c(sum(df2$v.m.ue.num) / NIAM2,
               sum(df3$v.m.ue.num) / NIAM3,
               sum(df4$v.m.ue.num) / NIAM4)

# Combine Results
catch_up_vaccination <- data.frame(
  Scenario = c("2% per Year", "3% per Year", "4% per Year"),
  NIA_Female = c(NIAF2, NIAF3, NIAF4),
  Percent_Averted_Female = Percent_Averted_Females,
  NNT_Female = NNT_Females,
  NIA_Male = c(NIAM2, NIAM3, NIAM4),
  Percent_Averted_Male = Percent_Averted_Males,
  NNT_Male = NNT_Males
)


View(catch_up_vaccination)
```


```{r}
ggplot(catch_up_vaccination, aes(x = Scenario)) +
  geom_bar(aes(y = NNT_Female, fill = "Female"), stat = "identity", position = position_dodge(width = 0.9)) +
  geom_bar(aes(y = NNT_Male, fill = "Male"), stat = "identity", position = position_dodge(width = 0.9)) +
  labs(title = "NNT for Females vs Males",
       x = "Scenario",
       y = "NNT",
       fill = "Gender") +
  scale_fill_manual(values = c("blue", "red"), labels = c("Female", "Male")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```





```{r Omega.m + kappa Vaccination}
# Isolate Runs
df1<-as.data.frame(mod4, run = 1)
df2<-as.data.frame(mod4, run = 2)
df3<-as.data.frame(mod4, run = 3)
df4<-as.data.frame(mod4, run = 4)

# Vaccination Measures for Females
NIAF2 <- sum(df1$si.f.flow) - sum(df2$si.f.flow)
NIAF3 <- sum(df1$si.f.flow) - sum(df3$si.f.flow)
NIAF4 <- sum(df1$si.f.flow) - sum(df4$si.f.flow)

Percent_Averted_Females <- c(NIAF2*100 / sum(df1$si.f.flow),
                             NIAF3*100 / sum(df1$si.f.flow),
                             NIAF4*100 / sum(df1$si.f.flow))

NNT_Females <- c(sum(df2$v.m.ue.num) / NIAF2,
                 sum(df3$v.m.ue.num) / NIAF3,
                 sum(df4$v.m.ue.num) / NIAF4)

# Vaccination Measures for Females
NIAM2 <- sum(df1$si.m.flow) - sum(df2$si.m.flow)
NIAM3 <- sum(df1$si.m.flow) - sum(df3$si.m.flow)
NIAM4 <- sum(df1$si.m.flow) - sum(df4$si.m.flow)

Percent_Averted_Males <- c(NIAM2*100 / sum(df1$si.m.flow),
                           NIAM3*100 / sum(df1$si.m.flow),
                           NIAM4*100 / sum(df1$si.m.flow))

NNT_Males <- c(sum(df2$v.m.ue.num) / NIAM2,
               sum(df3$v.m.ue.num) / NIAM3,
               sum(df4$v.m.ue.num) / NIAM4)

# Combine Results
joint_vaccination <- data.frame(
  Scenario = c("omega.m = 0.2 + kappa = 0.02", "omega.m = 0.3 + kappa = 0.03", "omega.m = 0.4 + kappa = 0.04"),
  NIA_Female = c(NIAF2, NIAF3, NIAF4),
  Percent_Averted_Female = Percent_Averted_Females,
  NNT_Female = NNT_Females,
  NIA_Male = c(NIAM2, NIAM3, NIAM4),
  Percent_Averted_Male = Percent_Averted_Males,
  NNT_Male = NNT_Males
)


View(joint_vaccination)
```



```{r}
ggplot(joint_vaccination, aes(x = Scenario)) +
  geom_bar(aes(y = NNT_Female, fill = "Female"), stat = "identity", position = position_dodge(width = 0.9)) +
  geom_bar(aes(y = NNT_Male, fill = "Male"), stat = "identity", position = position_dodge(width = 0.9)) +
  labs(title = "NNT for Females vs Males",
       x = "Scenario",
       y = "NNT",
       fill = "Gender") +
  scale_fill_manual(values = c("blue", "red"), labels = c("Female", "Male")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
mod<-mutate_epi(mod, ce.f=param$ce.m*m.num/f.num)

plot(mod, y="ce.f", ylim=c(3,3.2))
abline(h=param$ce.m, lty=2, lwd=2)
head(as.data.frame(mod))
```



```{r}
#Omega.m Scenario
#Overall Effect
df1<-as.data.frame(mod2, run = 1)
df2<-as.data.frame(mod2, run = 2)
df3<-as.data.frame(mod2, run = 3)
df4<-as.data.frame(mod2, run = 4)


NIA2 <- (sum(df1$si.f.flow)+sum(df1$si.m.flow)) - (sum(df2$si.f.flow)+sum(df2$si.m.flow))
NIA3 <- (sum(df1$si.f.flow)+sum(df1$si.m.flow)) - (sum(df3$si.f.flow)+sum(df3$si.m.flow))
NIA4 <- (sum(df1$si.f.flow)+sum(df1$si.m.flow)) - (sum(df4$si.f.flow)+sum(df4$si.m.flow))
#Direct Effects
NIAF2*(3.04e5+2.4e5+(sum(df2$v.m.ue.num)-3.04e5)+(sum(df2$v.f.ue.num)-2.4e5)*(.97/51254000))
DE2<- NIAF2*(sum(df2$v.m.ue.num)+sum(df2$v.f.ue.num)*(.97/51254000))
DE3<-NIAF3*(sum(df3$v.m.ue.num)+sum(df3$v.f.ue.num)*(.97/51254000))
DE4<-NIAF4*(sum(df4$v.m.ue.num)+sum(df4$v.f.ue.num)*(.97/51254000))
#Indirect Effects
NIA2-DE2
NIA3-DE3
NIA4-DE4
#Hi


